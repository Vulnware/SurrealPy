<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>surrealpy.http API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>surrealpy.http</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import sys
from typing import Optional, Union
import requests
from requests.auth import HTTPBasicAuth
import logging
import urllib.parse
from surrealpy.http.models import SurrealResponse
import aiohttp
from aiohttp import BasicAuth
from surrealpy.exceptions import ConnectionError, SurrealError
from surrealpy.utils import json_dumps, json_loads


def base_url(url, with_path=False):
    # Get From https://stackoverflow.com/questions/35616434/how-can-i-get-the-base-of-a-url-in-python
    parsed = urllib.parse.urlparse(url)
    path = &#34;/&#34;.join(parsed.path.split(&#34;/&#34;)[:-1]) if with_path else &#34;&#34;
    parsed = parsed._replace(path=path)
    parsed = parsed._replace(params=&#34;&#34;)
    parsed = parsed._replace(query=&#34;&#34;)
    parsed = parsed._replace(fragment=&#34;&#34;)
    return parsed.geturl()


# create logger object
logger = logging.getLogger(&#34;surrealpy.http&#34;)
logger.setLevel(logging.DEBUG)
logger.propagate = True
logger.debug(&#34;imported&#34;)


class SurrealAsyncClient:
    def __init__(
        self, uri: str, namespace: str, database: str, *, username: str, password: str
    ) -&gt; None:
        self.__session = aiohttp.ClientSession(
            auth=BasicAuth(username, password),
            headers={
                &#34;Content-Type&#34;: &#34;application/json&#34;,
                &#34;Accept&#34;: &#34;application/json&#34;,
                &#34;NS&#34;: namespace,
                &#34;DB&#34;: database,
            },
        )
        self.__uri = uri
        self.__baseurl = base_url(uri)

        self.__ns = namespace
        self.__db = database

    async def check(self):
        return await self.__check()

    @property
    def ns(self) -&gt; str:
        return self.__ns

    @property
    def db(self) -&gt; Union[dict, list]:
        # retrieve all databases
        return self.__db

    @property
    def tables(self) -&gt; Union[dict, list]:
        # retrieve all tables
        data = self.__query(&#34;INFO FOR DB;&#34;)
        for i in data[0][&#34;result&#34;][&#34;tb&#34;].keys():
            yield i

    @property
    def uri(self):
        return self.__uri

    async def __check(self):
        async with self.__session.head(self.uri) as resp:
            if resp.status == 200:
                return True
            else:
                return False

    async def __post(self, *extends, query: str) -&gt; Union[dict, list]:
        extend_uri = self.__baseurl + &#34;/&#34; + &#34;/&#34;.join(extends)
        async with self.__session.post(extend_uri, data=query) as response:
            respText = await response.text()
            logger.debug(respText)
            if response.status == 200:
                return json_loads(respText)
            elif response.status == 400:
                logger.error(respText)
                raise SurrealError(json_loads(respText)[&#34;information&#34;])
            else:
                logger.error(respText)
                return None

    async def __get(self, *extends) -&gt; Union[dict, list]:
        extend_uri = self.__baseurl + &#34;/&#34; + &#34;/&#34;.join(extends)
        async with self.__session.get(extend_uri) as response:
            respText = await response.text()
            if response.status == 200:
                return json_loads(respText)
            else:
                return None

    def __transform_into_sql_val(val):
        if isinstance(val, str):
            return &#34;&#39;%s&#39;&#34; % val
        return val

    async def raw_query(self, query: str) -&gt; Union[dict, list]:
        # execute a raw query
        return await self.__post(&#34;sql&#34;, query=query)

    async def mapped_query(self, query: str) -&gt; SurrealResponse:
        # execute a mapped query

        return SurrealResponse(self.raw_query(query))

    async def query(self, query: str, **kwargs) -&gt; Union[dict, list]:
        # query the database
        return await self.mapped_query(query.format(**kwargs))

    async def let(self, key, val):
        return await self.mapped_query(
            &#34;LET ${}={}&#34;.format(key, self.__transform_into_sql_val(val))
        )

    async def select(self, tid: str):
        &#34;&#34;&#34;tid can be a table name or a record id&#34;&#34;&#34;
        return await self.mapped_query(&#34;SELECT * FROM {}&#34;.format(tid))

    async def create(self, tid: str, data: Optional[dict] = None):
        return (
            await self.mapped_query(f&#34;CREATE {tid} CONTENT {json_dumps(data)}&#34;)
            if data is not None
            else self.mapped_query(f&#34;CREATE {tid}&#34;)
        )

    async def update(self, tid: str, data: Optional[dict] = None):
        return (
            await self.mapped_query(f&#34;UPDATE {tid}&#34;)
            if data is not None
            else self.mapped_query(f&#34;UPDATE {tid} CONTENT {json_dumps(data)}&#34;)
        )

    async def change(self, tid: str, data: Optional[dict] = None):
        return (
            await self.mapped_query(f&#34;UPDATE {tid}&#34;)
            if data is not None
            else self.mapped_query(f&#34;UPDATE {tid} MERGE {json_dumps(data)}&#34;)
        )

    async def modify(self, tid: str, data: Optional[dict] = None):
        return (
            await self.mapped_query(f&#34;UPDATE {tid}&#34;)
            if data is not None
            else self.mapped_query(f&#34;UPDATE {tid} PATCH {json_dumps(data)}&#34;)
        )

    async def delete(self, tid: str):
        return await self.mapped_query(f&#34;DELETE * FROM {tid}&#34;)


class SurrealClient:
    def __init__(
        self, uri: str, namespace: str, database: str, *, username: str, password: str
    ) -&gt; None:
        self.__session = requests.session()
        self.__session.auth = HTTPBasicAuth(username, password)
        self.__session.headers.update(
            {
                &#34;Content-Type&#34;: &#34;application/json&#34;,
                &#34;Accept&#34;: &#34;application/json&#34;,
                &#34;NS&#34;: namespace,
                &#34;DB&#34;: database,
            }
        )
        self.__uri = uri
        self.__baseurl = base_url(uri)
        if self.__check() is False:
            raise ConnectionError(&#34;Connection Error&#34;)
        self.__ns = namespace
        self.__db = database

    @property
    def ns(self) -&gt; str:
        return self.__ns

    @property
    def db(self) -&gt; Union[dict, list]:
        # retrieve all databases
        return self.__db

    @property
    def tables(self) -&gt; Union[dict, list]:
        # retrieve all tables
        data = self.raw_query(&#34;INFO FOR DB;&#34;)
        for i in data[0][&#34;result&#34;][&#34;tb&#34;].keys():
            yield i

    @property
    def uri(self):
        return self.__uri

    def __check(self):
        try:
            with self.__session.head(self.__uri) as response:
                logger.debug(response.status_code)
                logger.debug(response.text)
                logger.debug(response.headers)
                logger.debug(response.request.headers)
                logger.debug(response.request.body)
                return True
        except requests.Timeout as e:
            logger.error(e)
            return False
        except requests.ConnectionError as e:
            logger.error(e)
            return False
        except requests.RequestException as e:
            logger.error(e)
            return False
        except Exception as e:
            logger.error(e)
            return False
        else:
            logger.debug(&#34;connection successful&#34;)

    def __post(self, *extends, query: str) -&gt; Union[dict, list]:
        extend_uri = self.__baseurl + &#34;/&#34; + &#34;/&#34;.join(extends)
        with self.__session.post(extend_uri, data=query) as response:
            logger.debug(response.text)
            if response.status_code == 200:
                return json_loads(response.text)
            elif response.status_code == 400:
                logger.error(response.text)
                raise SurrealError(json_loads(response.text)[&#34;information&#34;])
            else:
                logger.error(response.text)
                return None

    def __get(self, *extends) -&gt; Union[dict, list]:
        extend_uri = self.__baseurl + &#34;/&#34; + &#34;/&#34;.join(extends)
        with self.__session.get(extend_uri) as response:
            logger.debug(response.text)
            if response.status_code == 200:
                return json_loads(response.text)
            else:
                return None

    def __transform_into_sql_val(val):
        if isinstance(val, str):
            return &#34;&#39;%s&#39;&#34; % val
        return val

    def raw_query(self, query: str) -&gt; Union[dict, list]:
        # execute a raw query
        return self.__post(&#34;sql&#34;, query=query)

    def mapped_query(self, query: str) -&gt; SurrealResponse:
        # execute a mapped query
        return SurrealResponse(self.raw_query(query))

    def query(self, query: str, **kwargs) -&gt; Union[dict, list]:
        # query the database
        return self.mapped_query(query.format(**kwargs))

    def let(self, key, val):
        return self.mapped_query(
            &#34;LET ${}={}&#34;.format(key, self.__transform_into_sql_val(val))
        )

    def select(self, tid: str):
        &#34;&#34;&#34;tid can be a table name or a record id&#34;&#34;&#34;
        return self.mapped_query(&#34;SELECT * FROM {}&#34;.format(tid))

    def create(self, tid: str, data: Optional[dict] = None):
        return (
            self.mapped_query(f&#34;CREATE {tid} CONTENT {json_dumps(data)}&#34;)
            if data is not None
            else self.mapped_query(f&#34;CREATE {tid}&#34;)
        )

    def update(self, tid: str, data: Optional[dict] = None):
        return (
            self.mapped_query(f&#34;UPDATE {tid}&#34;)
            if data is not None
            else self.mapped_query(f&#34;UPDATE {tid} CONTENT {json_dumps(data)}&#34;)
        )

    def change(self, tid: str, data: Optional[dict] = None):
        return (
            self.mapped_query(f&#34;UPDATE {tid}&#34;)
            if data is not None
            else self.mapped_query(f&#34;UPDATE {tid} MERGE {json_dumps(data)}&#34;)
        )

    def modify(self, tid: str, data: Optional[dict] = None):
        return (
            self.mapped_query(f&#34;UPDATE {tid}&#34;)
            if data is not None
            else self.mapped_query(f&#34;UPDATE {tid} PATCH {json_dumps(data)}&#34;)
        )

    def delete(self, tid: str):
        return self.mapped_query(f&#34;DELETE * FROM {tid}&#34;)</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="surrealpy.http.models" href="models.html">surrealpy.http.models</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="surrealpy.http.base_url"><code class="name flex">
<span>def <span class="ident">base_url</span></span>(<span>url, with_path=False)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def base_url(url, with_path=False):
    # Get From https://stackoverflow.com/questions/35616434/how-can-i-get-the-base-of-a-url-in-python
    parsed = urllib.parse.urlparse(url)
    path = &#34;/&#34;.join(parsed.path.split(&#34;/&#34;)[:-1]) if with_path else &#34;&#34;
    parsed = parsed._replace(path=path)
    parsed = parsed._replace(params=&#34;&#34;)
    parsed = parsed._replace(query=&#34;&#34;)
    parsed = parsed._replace(fragment=&#34;&#34;)
    return parsed.geturl()</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="surrealpy.http.SurrealAsyncClient"><code class="flex name class">
<span>class <span class="ident">SurrealAsyncClient</span></span>
<span>(</span><span>uri: str, namespace: str, database: str, *, username: str, password: str)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SurrealAsyncClient:
    def __init__(
        self, uri: str, namespace: str, database: str, *, username: str, password: str
    ) -&gt; None:
        self.__session = aiohttp.ClientSession(
            auth=BasicAuth(username, password),
            headers={
                &#34;Content-Type&#34;: &#34;application/json&#34;,
                &#34;Accept&#34;: &#34;application/json&#34;,
                &#34;NS&#34;: namespace,
                &#34;DB&#34;: database,
            },
        )
        self.__uri = uri
        self.__baseurl = base_url(uri)

        self.__ns = namespace
        self.__db = database

    async def check(self):
        return await self.__check()

    @property
    def ns(self) -&gt; str:
        return self.__ns

    @property
    def db(self) -&gt; Union[dict, list]:
        # retrieve all databases
        return self.__db

    @property
    def tables(self) -&gt; Union[dict, list]:
        # retrieve all tables
        data = self.__query(&#34;INFO FOR DB;&#34;)
        for i in data[0][&#34;result&#34;][&#34;tb&#34;].keys():
            yield i

    @property
    def uri(self):
        return self.__uri

    async def __check(self):
        async with self.__session.head(self.uri) as resp:
            if resp.status == 200:
                return True
            else:
                return False

    async def __post(self, *extends, query: str) -&gt; Union[dict, list]:
        extend_uri = self.__baseurl + &#34;/&#34; + &#34;/&#34;.join(extends)
        async with self.__session.post(extend_uri, data=query) as response:
            respText = await response.text()
            logger.debug(respText)
            if response.status == 200:
                return json_loads(respText)
            elif response.status == 400:
                logger.error(respText)
                raise SurrealError(json_loads(respText)[&#34;information&#34;])
            else:
                logger.error(respText)
                return None

    async def __get(self, *extends) -&gt; Union[dict, list]:
        extend_uri = self.__baseurl + &#34;/&#34; + &#34;/&#34;.join(extends)
        async with self.__session.get(extend_uri) as response:
            respText = await response.text()
            if response.status == 200:
                return json_loads(respText)
            else:
                return None

    def __transform_into_sql_val(val):
        if isinstance(val, str):
            return &#34;&#39;%s&#39;&#34; % val
        return val

    async def raw_query(self, query: str) -&gt; Union[dict, list]:
        # execute a raw query
        return await self.__post(&#34;sql&#34;, query=query)

    async def mapped_query(self, query: str) -&gt; SurrealResponse:
        # execute a mapped query

        return SurrealResponse(self.raw_query(query))

    async def query(self, query: str, **kwargs) -&gt; Union[dict, list]:
        # query the database
        return await self.mapped_query(query.format(**kwargs))

    async def let(self, key, val):
        return await self.mapped_query(
            &#34;LET ${}={}&#34;.format(key, self.__transform_into_sql_val(val))
        )

    async def select(self, tid: str):
        &#34;&#34;&#34;tid can be a table name or a record id&#34;&#34;&#34;
        return await self.mapped_query(&#34;SELECT * FROM {}&#34;.format(tid))

    async def create(self, tid: str, data: Optional[dict] = None):
        return (
            await self.mapped_query(f&#34;CREATE {tid} CONTENT {json_dumps(data)}&#34;)
            if data is not None
            else self.mapped_query(f&#34;CREATE {tid}&#34;)
        )

    async def update(self, tid: str, data: Optional[dict] = None):
        return (
            await self.mapped_query(f&#34;UPDATE {tid}&#34;)
            if data is not None
            else self.mapped_query(f&#34;UPDATE {tid} CONTENT {json_dumps(data)}&#34;)
        )

    async def change(self, tid: str, data: Optional[dict] = None):
        return (
            await self.mapped_query(f&#34;UPDATE {tid}&#34;)
            if data is not None
            else self.mapped_query(f&#34;UPDATE {tid} MERGE {json_dumps(data)}&#34;)
        )

    async def modify(self, tid: str, data: Optional[dict] = None):
        return (
            await self.mapped_query(f&#34;UPDATE {tid}&#34;)
            if data is not None
            else self.mapped_query(f&#34;UPDATE {tid} PATCH {json_dumps(data)}&#34;)
        )

    async def delete(self, tid: str):
        return await self.mapped_query(f&#34;DELETE * FROM {tid}&#34;)</code></pre>
</details>
<h3>Instance variables</h3>
<dl>
<dt id="surrealpy.http.SurrealAsyncClient.db"><code class="name">var <span class="ident">db</span> : Union[dict, list]</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def db(self) -&gt; Union[dict, list]:
    # retrieve all databases
    return self.__db</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealAsyncClient.ns"><code class="name">var <span class="ident">ns</span> : str</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def ns(self) -&gt; str:
    return self.__ns</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealAsyncClient.tables"><code class="name">var <span class="ident">tables</span> : Union[dict, list]</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def tables(self) -&gt; Union[dict, list]:
    # retrieve all tables
    data = self.__query(&#34;INFO FOR DB;&#34;)
    for i in data[0][&#34;result&#34;][&#34;tb&#34;].keys():
        yield i</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealAsyncClient.uri"><code class="name">var <span class="ident">uri</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def uri(self):
    return self.__uri</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="surrealpy.http.SurrealAsyncClient.change"><code class="name flex">
<span>async def <span class="ident">change</span></span>(<span>self, tid: str, data: Optional[dict] = None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">async def change(self, tid: str, data: Optional[dict] = None):
    return (
        await self.mapped_query(f&#34;UPDATE {tid}&#34;)
        if data is not None
        else self.mapped_query(f&#34;UPDATE {tid} MERGE {json_dumps(data)}&#34;)
    )</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealAsyncClient.check"><code class="name flex">
<span>async def <span class="ident">check</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">async def check(self):
    return await self.__check()</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealAsyncClient.create"><code class="name flex">
<span>async def <span class="ident">create</span></span>(<span>self, tid: str, data: Optional[dict] = None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">async def create(self, tid: str, data: Optional[dict] = None):
    return (
        await self.mapped_query(f&#34;CREATE {tid} CONTENT {json_dumps(data)}&#34;)
        if data is not None
        else self.mapped_query(f&#34;CREATE {tid}&#34;)
    )</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealAsyncClient.delete"><code class="name flex">
<span>async def <span class="ident">delete</span></span>(<span>self, tid: str)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">async def delete(self, tid: str):
    return await self.mapped_query(f&#34;DELETE * FROM {tid}&#34;)</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealAsyncClient.let"><code class="name flex">
<span>async def <span class="ident">let</span></span>(<span>self, key, val)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">async def let(self, key, val):
    return await self.mapped_query(
        &#34;LET ${}={}&#34;.format(key, self.__transform_into_sql_val(val))
    )</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealAsyncClient.mapped_query"><code class="name flex">
<span>async def <span class="ident">mapped_query</span></span>(<span>self, query: str) ‑> <a title="surrealpy.http.models.SurrealResponse" href="models.html#surrealpy.http.models.SurrealResponse">SurrealResponse</a></span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">async def mapped_query(self, query: str) -&gt; SurrealResponse:
    # execute a mapped query

    return SurrealResponse(self.raw_query(query))</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealAsyncClient.modify"><code class="name flex">
<span>async def <span class="ident">modify</span></span>(<span>self, tid: str, data: Optional[dict] = None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">async def modify(self, tid: str, data: Optional[dict] = None):
    return (
        await self.mapped_query(f&#34;UPDATE {tid}&#34;)
        if data is not None
        else self.mapped_query(f&#34;UPDATE {tid} PATCH {json_dumps(data)}&#34;)
    )</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealAsyncClient.query"><code class="name flex">
<span>async def <span class="ident">query</span></span>(<span>self, query: str, **kwargs) ‑> Union[dict, list]</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">async def query(self, query: str, **kwargs) -&gt; Union[dict, list]:
    # query the database
    return await self.mapped_query(query.format(**kwargs))</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealAsyncClient.raw_query"><code class="name flex">
<span>async def <span class="ident">raw_query</span></span>(<span>self, query: str) ‑> Union[dict, list]</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">async def raw_query(self, query: str) -&gt; Union[dict, list]:
    # execute a raw query
    return await self.__post(&#34;sql&#34;, query=query)</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealAsyncClient.select"><code class="name flex">
<span>async def <span class="ident">select</span></span>(<span>self, tid: str)</span>
</code></dt>
<dd>
<div class="desc"><p>tid can be a table name or a record id</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">async def select(self, tid: str):
    &#34;&#34;&#34;tid can be a table name or a record id&#34;&#34;&#34;
    return await self.mapped_query(&#34;SELECT * FROM {}&#34;.format(tid))</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealAsyncClient.update"><code class="name flex">
<span>async def <span class="ident">update</span></span>(<span>self, tid: str, data: Optional[dict] = None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">async def update(self, tid: str, data: Optional[dict] = None):
    return (
        await self.mapped_query(f&#34;UPDATE {tid}&#34;)
        if data is not None
        else self.mapped_query(f&#34;UPDATE {tid} CONTENT {json_dumps(data)}&#34;)
    )</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="surrealpy.http.SurrealClient"><code class="flex name class">
<span>class <span class="ident">SurrealClient</span></span>
<span>(</span><span>uri: str, namespace: str, database: str, *, username: str, password: str)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SurrealClient:
    def __init__(
        self, uri: str, namespace: str, database: str, *, username: str, password: str
    ) -&gt; None:
        self.__session = requests.session()
        self.__session.auth = HTTPBasicAuth(username, password)
        self.__session.headers.update(
            {
                &#34;Content-Type&#34;: &#34;application/json&#34;,
                &#34;Accept&#34;: &#34;application/json&#34;,
                &#34;NS&#34;: namespace,
                &#34;DB&#34;: database,
            }
        )
        self.__uri = uri
        self.__baseurl = base_url(uri)
        if self.__check() is False:
            raise ConnectionError(&#34;Connection Error&#34;)
        self.__ns = namespace
        self.__db = database

    @property
    def ns(self) -&gt; str:
        return self.__ns

    @property
    def db(self) -&gt; Union[dict, list]:
        # retrieve all databases
        return self.__db

    @property
    def tables(self) -&gt; Union[dict, list]:
        # retrieve all tables
        data = self.raw_query(&#34;INFO FOR DB;&#34;)
        for i in data[0][&#34;result&#34;][&#34;tb&#34;].keys():
            yield i

    @property
    def uri(self):
        return self.__uri

    def __check(self):
        try:
            with self.__session.head(self.__uri) as response:
                logger.debug(response.status_code)
                logger.debug(response.text)
                logger.debug(response.headers)
                logger.debug(response.request.headers)
                logger.debug(response.request.body)
                return True
        except requests.Timeout as e:
            logger.error(e)
            return False
        except requests.ConnectionError as e:
            logger.error(e)
            return False
        except requests.RequestException as e:
            logger.error(e)
            return False
        except Exception as e:
            logger.error(e)
            return False
        else:
            logger.debug(&#34;connection successful&#34;)

    def __post(self, *extends, query: str) -&gt; Union[dict, list]:
        extend_uri = self.__baseurl + &#34;/&#34; + &#34;/&#34;.join(extends)
        with self.__session.post(extend_uri, data=query) as response:
            logger.debug(response.text)
            if response.status_code == 200:
                return json_loads(response.text)
            elif response.status_code == 400:
                logger.error(response.text)
                raise SurrealError(json_loads(response.text)[&#34;information&#34;])
            else:
                logger.error(response.text)
                return None

    def __get(self, *extends) -&gt; Union[dict, list]:
        extend_uri = self.__baseurl + &#34;/&#34; + &#34;/&#34;.join(extends)
        with self.__session.get(extend_uri) as response:
            logger.debug(response.text)
            if response.status_code == 200:
                return json_loads(response.text)
            else:
                return None

    def __transform_into_sql_val(val):
        if isinstance(val, str):
            return &#34;&#39;%s&#39;&#34; % val
        return val

    def raw_query(self, query: str) -&gt; Union[dict, list]:
        # execute a raw query
        return self.__post(&#34;sql&#34;, query=query)

    def mapped_query(self, query: str) -&gt; SurrealResponse:
        # execute a mapped query
        return SurrealResponse(self.raw_query(query))

    def query(self, query: str, **kwargs) -&gt; Union[dict, list]:
        # query the database
        return self.mapped_query(query.format(**kwargs))

    def let(self, key, val):
        return self.mapped_query(
            &#34;LET ${}={}&#34;.format(key, self.__transform_into_sql_val(val))
        )

    def select(self, tid: str):
        &#34;&#34;&#34;tid can be a table name or a record id&#34;&#34;&#34;
        return self.mapped_query(&#34;SELECT * FROM {}&#34;.format(tid))

    def create(self, tid: str, data: Optional[dict] = None):
        return (
            self.mapped_query(f&#34;CREATE {tid} CONTENT {json_dumps(data)}&#34;)
            if data is not None
            else self.mapped_query(f&#34;CREATE {tid}&#34;)
        )

    def update(self, tid: str, data: Optional[dict] = None):
        return (
            self.mapped_query(f&#34;UPDATE {tid}&#34;)
            if data is not None
            else self.mapped_query(f&#34;UPDATE {tid} CONTENT {json_dumps(data)}&#34;)
        )

    def change(self, tid: str, data: Optional[dict] = None):
        return (
            self.mapped_query(f&#34;UPDATE {tid}&#34;)
            if data is not None
            else self.mapped_query(f&#34;UPDATE {tid} MERGE {json_dumps(data)}&#34;)
        )

    def modify(self, tid: str, data: Optional[dict] = None):
        return (
            self.mapped_query(f&#34;UPDATE {tid}&#34;)
            if data is not None
            else self.mapped_query(f&#34;UPDATE {tid} PATCH {json_dumps(data)}&#34;)
        )

    def delete(self, tid: str):
        return self.mapped_query(f&#34;DELETE * FROM {tid}&#34;)</code></pre>
</details>
<h3>Instance variables</h3>
<dl>
<dt id="surrealpy.http.SurrealClient.db"><code class="name">var <span class="ident">db</span> : Union[dict, list]</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def db(self) -&gt; Union[dict, list]:
    # retrieve all databases
    return self.__db</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealClient.ns"><code class="name">var <span class="ident">ns</span> : str</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def ns(self) -&gt; str:
    return self.__ns</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealClient.tables"><code class="name">var <span class="ident">tables</span> : Union[dict, list]</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def tables(self) -&gt; Union[dict, list]:
    # retrieve all tables
    data = self.raw_query(&#34;INFO FOR DB;&#34;)
    for i in data[0][&#34;result&#34;][&#34;tb&#34;].keys():
        yield i</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealClient.uri"><code class="name">var <span class="ident">uri</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def uri(self):
    return self.__uri</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="surrealpy.http.SurrealClient.change"><code class="name flex">
<span>def <span class="ident">change</span></span>(<span>self, tid: str, data: Optional[dict] = None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def change(self, tid: str, data: Optional[dict] = None):
    return (
        self.mapped_query(f&#34;UPDATE {tid}&#34;)
        if data is not None
        else self.mapped_query(f&#34;UPDATE {tid} MERGE {json_dumps(data)}&#34;)
    )</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealClient.create"><code class="name flex">
<span>def <span class="ident">create</span></span>(<span>self, tid: str, data: Optional[dict] = None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def create(self, tid: str, data: Optional[dict] = None):
    return (
        self.mapped_query(f&#34;CREATE {tid} CONTENT {json_dumps(data)}&#34;)
        if data is not None
        else self.mapped_query(f&#34;CREATE {tid}&#34;)
    )</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealClient.delete"><code class="name flex">
<span>def <span class="ident">delete</span></span>(<span>self, tid: str)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def delete(self, tid: str):
    return self.mapped_query(f&#34;DELETE * FROM {tid}&#34;)</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealClient.let"><code class="name flex">
<span>def <span class="ident">let</span></span>(<span>self, key, val)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def let(self, key, val):
    return self.mapped_query(
        &#34;LET ${}={}&#34;.format(key, self.__transform_into_sql_val(val))
    )</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealClient.mapped_query"><code class="name flex">
<span>def <span class="ident">mapped_query</span></span>(<span>self, query: str) ‑> <a title="surrealpy.http.models.SurrealResponse" href="models.html#surrealpy.http.models.SurrealResponse">SurrealResponse</a></span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def mapped_query(self, query: str) -&gt; SurrealResponse:
    # execute a mapped query
    return SurrealResponse(self.raw_query(query))</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealClient.modify"><code class="name flex">
<span>def <span class="ident">modify</span></span>(<span>self, tid: str, data: Optional[dict] = None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def modify(self, tid: str, data: Optional[dict] = None):
    return (
        self.mapped_query(f&#34;UPDATE {tid}&#34;)
        if data is not None
        else self.mapped_query(f&#34;UPDATE {tid} PATCH {json_dumps(data)}&#34;)
    )</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealClient.query"><code class="name flex">
<span>def <span class="ident">query</span></span>(<span>self, query: str, **kwargs) ‑> Union[dict, list]</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def query(self, query: str, **kwargs) -&gt; Union[dict, list]:
    # query the database
    return self.mapped_query(query.format(**kwargs))</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealClient.raw_query"><code class="name flex">
<span>def <span class="ident">raw_query</span></span>(<span>self, query: str) ‑> Union[dict, list]</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def raw_query(self, query: str) -&gt; Union[dict, list]:
    # execute a raw query
    return self.__post(&#34;sql&#34;, query=query)</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealClient.select"><code class="name flex">
<span>def <span class="ident">select</span></span>(<span>self, tid: str)</span>
</code></dt>
<dd>
<div class="desc"><p>tid can be a table name or a record id</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def select(self, tid: str):
    &#34;&#34;&#34;tid can be a table name or a record id&#34;&#34;&#34;
    return self.mapped_query(&#34;SELECT * FROM {}&#34;.format(tid))</code></pre>
</details>
</dd>
<dt id="surrealpy.http.SurrealClient.update"><code class="name flex">
<span>def <span class="ident">update</span></span>(<span>self, tid: str, data: Optional[dict] = None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def update(self, tid: str, data: Optional[dict] = None):
    return (
        self.mapped_query(f&#34;UPDATE {tid}&#34;)
        if data is not None
        else self.mapped_query(f&#34;UPDATE {tid} CONTENT {json_dumps(data)}&#34;)
    )</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="surrealpy" href="../index.html">surrealpy</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="surrealpy.http.models" href="models.html">surrealpy.http.models</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="surrealpy.http.base_url" href="#surrealpy.http.base_url">base_url</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="surrealpy.http.SurrealAsyncClient" href="#surrealpy.http.SurrealAsyncClient">SurrealAsyncClient</a></code></h4>
<ul class="two-column">
<li><code><a title="surrealpy.http.SurrealAsyncClient.change" href="#surrealpy.http.SurrealAsyncClient.change">change</a></code></li>
<li><code><a title="surrealpy.http.SurrealAsyncClient.check" href="#surrealpy.http.SurrealAsyncClient.check">check</a></code></li>
<li><code><a title="surrealpy.http.SurrealAsyncClient.create" href="#surrealpy.http.SurrealAsyncClient.create">create</a></code></li>
<li><code><a title="surrealpy.http.SurrealAsyncClient.db" href="#surrealpy.http.SurrealAsyncClient.db">db</a></code></li>
<li><code><a title="surrealpy.http.SurrealAsyncClient.delete" href="#surrealpy.http.SurrealAsyncClient.delete">delete</a></code></li>
<li><code><a title="surrealpy.http.SurrealAsyncClient.let" href="#surrealpy.http.SurrealAsyncClient.let">let</a></code></li>
<li><code><a title="surrealpy.http.SurrealAsyncClient.mapped_query" href="#surrealpy.http.SurrealAsyncClient.mapped_query">mapped_query</a></code></li>
<li><code><a title="surrealpy.http.SurrealAsyncClient.modify" href="#surrealpy.http.SurrealAsyncClient.modify">modify</a></code></li>
<li><code><a title="surrealpy.http.SurrealAsyncClient.ns" href="#surrealpy.http.SurrealAsyncClient.ns">ns</a></code></li>
<li><code><a title="surrealpy.http.SurrealAsyncClient.query" href="#surrealpy.http.SurrealAsyncClient.query">query</a></code></li>
<li><code><a title="surrealpy.http.SurrealAsyncClient.raw_query" href="#surrealpy.http.SurrealAsyncClient.raw_query">raw_query</a></code></li>
<li><code><a title="surrealpy.http.SurrealAsyncClient.select" href="#surrealpy.http.SurrealAsyncClient.select">select</a></code></li>
<li><code><a title="surrealpy.http.SurrealAsyncClient.tables" href="#surrealpy.http.SurrealAsyncClient.tables">tables</a></code></li>
<li><code><a title="surrealpy.http.SurrealAsyncClient.update" href="#surrealpy.http.SurrealAsyncClient.update">update</a></code></li>
<li><code><a title="surrealpy.http.SurrealAsyncClient.uri" href="#surrealpy.http.SurrealAsyncClient.uri">uri</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="surrealpy.http.SurrealClient" href="#surrealpy.http.SurrealClient">SurrealClient</a></code></h4>
<ul class="two-column">
<li><code><a title="surrealpy.http.SurrealClient.change" href="#surrealpy.http.SurrealClient.change">change</a></code></li>
<li><code><a title="surrealpy.http.SurrealClient.create" href="#surrealpy.http.SurrealClient.create">create</a></code></li>
<li><code><a title="surrealpy.http.SurrealClient.db" href="#surrealpy.http.SurrealClient.db">db</a></code></li>
<li><code><a title="surrealpy.http.SurrealClient.delete" href="#surrealpy.http.SurrealClient.delete">delete</a></code></li>
<li><code><a title="surrealpy.http.SurrealClient.let" href="#surrealpy.http.SurrealClient.let">let</a></code></li>
<li><code><a title="surrealpy.http.SurrealClient.mapped_query" href="#surrealpy.http.SurrealClient.mapped_query">mapped_query</a></code></li>
<li><code><a title="surrealpy.http.SurrealClient.modify" href="#surrealpy.http.SurrealClient.modify">modify</a></code></li>
<li><code><a title="surrealpy.http.SurrealClient.ns" href="#surrealpy.http.SurrealClient.ns">ns</a></code></li>
<li><code><a title="surrealpy.http.SurrealClient.query" href="#surrealpy.http.SurrealClient.query">query</a></code></li>
<li><code><a title="surrealpy.http.SurrealClient.raw_query" href="#surrealpy.http.SurrealClient.raw_query">raw_query</a></code></li>
<li><code><a title="surrealpy.http.SurrealClient.select" href="#surrealpy.http.SurrealClient.select">select</a></code></li>
<li><code><a title="surrealpy.http.SurrealClient.tables" href="#surrealpy.http.SurrealClient.tables">tables</a></code></li>
<li><code><a title="surrealpy.http.SurrealClient.update" href="#surrealpy.http.SurrealClient.update">update</a></code></li>
<li><code><a title="surrealpy.http.SurrealClient.uri" href="#surrealpy.http.SurrealClient.uri">uri</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>